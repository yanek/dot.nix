version: '3'

tasks:
  build:
    cmds:
      - git add .
      - git diff --staged --name-status
      - sudo nixos-rebuild switch --flake .
      - home-manager switch --flake .

  update:
    cmds:
      - nix flake update
      - task: build

  clean:
    cmds:
      - sudo nix-collect-garbage --delete-older-than 7d
